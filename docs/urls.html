<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>urls.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>urls.py</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-0'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-0">#</a>
        </div>
        <p>Provides some basic defaults for passing requests straight through to
CouchDB with minimal settings.  Using these <code>urlpatterns</code> requires a
configured <code>settings</code> module with the default values.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><div class="highlight"><pre></pre></div></pre></div>
      </td>
    </tr><tr id='section-1'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-1">#</a>
        </div>
        <p>Import the pieces of Django's URL system that we're going to use.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls.defaults</span> <span class="kn">import</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">url</span></pre></div></pre></div>
      </td>
    </tr><tr id='section-2'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-2">#</a>
        </div>
        <p>Define a template string that all URLs will match against.  This needs
to have the type injected into it.  Using this regular expression, we
extract the name value and pass it to the view.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><div class="highlight"><pre><span class="n">URL_PATTERN</span> <span class="o">=</span> <span class="s">r&#39;</span><span class="si">%s</span><span class="s">/(?P&lt;name&gt;.*)$&#39;</span></pre></div></pre></div>
      </td>
    </tr><tr id='section-3'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-3">#</a>
        </div>
        <p>The default parameters we want to pass are only <code>relay_params</code> set
to <code>True</code>.  All other parameters are assumed to be the default.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><div class="highlight"><pre><span class="n">DEFAULT_PARAMS</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;relay_params&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span></pre></div></pre></div>
      </td>
    </tr><tr id='section-4'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-4">#</a>
        </div>
        <p>Now we need to create a way to generate all of the matching URLs.
This function takes any number of parameters, and generates a matching
<code>django.conf.urls.default.url</code> value for it, returning all of the
values as a list.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><div class="highlight"><pre><span class="k">def</span> <span class="nf">generate_view_pattern</span><span class="p">(</span><span class="o">*</span><span class="n">types</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">url</span><span class="p">(</span><span class="n">URL_PATTERN</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">DEFAULT_PARAMS</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">types</span><span class="p">]</span></pre></div></pre></div>
      </td>
    </tr><tr id='section-5'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-5">#</a>
        </div>
        <p>Now we define a <code>urlpatterns</code> for Django to consume.  We assume that
we're relaying all GET parameters and doing little else.  These also
assume the default templates.</p>
<p>This uses the <code>generate_view_pattern</code> above to generate all of the
views needed to provide the basic patterns to match <code>list</code>,
<code>show</code>, and <code>view</code>.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><div class="highlight"><pre><span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">&#39;armstrong.apps.couchdb.views&#39;</span><span class="p">,</span>
                       <span class="o">*</span><span class="n">generate_view_pattern</span><span class="p">(</span><span class="s">&#39;list&#39;</span><span class="p">,</span> <span class="s">&#39;show&#39;</span><span class="p">,</span> <span class="s">&#39;view&#39;</span><span class="p">))</span>

</pre></div></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
